## import dataset ##

#Atlantic Temperature#
NOWHERE <- read.csv("~/Downloads/NOWHERE.csv")

##mean of monthly values##

NOWHERE <- NOWHERE |>
  group_by(year, month) |>
  summarise(mean_temp = mean(mean.temperature.deg.C, na.rm = TRUE),
            .groups = 'drop') |>
  mutate(month_year = yearmonth(paste(year, month, sep = "-")))

NOWHERE$date <- as.Date(with(NOWHERE2, paste(year, month, day, sep="-")), "%Y-%m-%d")
TemperatureAthlantic <- NOWHERE
ts_Temperature <- as_tsibble(TemperatureAtlantic, index = month_year)

#C02 Monthly#
archive <- read.csv("~/Downloads/archive.csv")

ts_C02 <- archive |> transform(Date = as.Date(paste(year, month, day, sep = "-"))) |>
  +     as_tsibble(index = Date)

** regression computation **

library(forecast)
data <- data.frame(TimeSeries1 = ts_Temperature, TimeSeries2 = ts_C02)
model <- lm(TimeSeries1 ~ TimeSeries2, data = data)
summary(model)

** plot temperature**
  ggplot(data, aes(x = data$TS1.month_year, y = TS1.mean_temp)) +
  geom_line() +
  labs(title = "Evolution of Time Series 1", x = "Date", y = "Temperature")


 **C02**

ggplot(data, aes(x = data$TS2.month_year, y = TS2.mean_c02)) +
  geom_line() +
  labs(title = "Evolution of Time Series 2", x = "Date", y = "CO2 Concentration")





